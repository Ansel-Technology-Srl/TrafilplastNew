import{j as e}from"./vendor-three-CHCIWYOy.js";import{f as s,r as t,L as r}from"./vendor-react-DmByJA4P.js";import{a,P as n,v as i}from"./index-DG0WW0gK.js";import{u as o}from"./vendor-i18n-BveTNVnu.js";import"./vendor-ui-CwcPvQqL.js";function l(){const{t:l}=o(),[d]=s(),c=d.get("token")||"",[m,x]=t.useState(""),[h,u]=t.useState(""),[p,j]=t.useState(!1),[g,f]=t.useState(!1),[v,w]=t.useState(!0),[b,y]=t.useState(!1),[N,k]=t.useState(""),[L,C]=t.useState(!1),[M,S]=t.useState("");t.useEffect(()=>{if(!c)return k(l("auth.resetInvalidToken")),void w(!1);(async()=>{try{const e=await a.get(`/auth/validate-reset-token?token=${encodeURIComponent(c)}`);e?.success?y(!0):k(e?.message||l("auth.resetInvalidToken"))}catch{k(l("auth.resetInvalidToken"))}finally{w(!1)}})()},[c,l]);return v?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("svg",{className:"animate-spin h-10 w-10 text-primary-600 mx-auto mb-4",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("p",{className:"text-gray-500",children:l("app.loading")})]})}):b||L?L?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsx("div",{className:"w-full max-w-[420px] text-center",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 bg-green-100 rounded-full mb-4",children:e.jsx("svg",{className:"w-7 h-7 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:l("auth.resetTitle")}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:l("auth.resetSuccess")}),e.jsxs(r,{to:"/login",className:"btn-primary inline-flex items-center gap-2 px-6 py-2.5",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),l("auth.resetGoToLogin")]})]})})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"w-full max-w-[420px]",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-primary-100 rounded-2xl mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:l("auth.resetTitle")}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:l("auth.resetSubtitle")})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-8",children:[M&&e.jsxs("div",{className:"mb-5 flex items-start gap-3 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm",role:"alert",children:[e.jsx("svg",{className:"w-5 h-5 text-red-500 shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}),e.jsx("span",{children:M})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),S(""),m===h)if(i(m)){f(!0);try{const e=await a.post("/auth/reset-password",{token:c,newPassword:m});e?.success?C(!0):S(e?.message||"Errore durante il reset.")}catch{S("Errore di connessione al server.")}finally{f(!1)}}else S(l("auth.passwordRules"));else S(l("auth.passwordMismatch"))},className:"space-y-5",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1.5",children:l("auth.newPassword")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"newPassword",type:p?"text":"password",value:m,onChange:e=>{x(e.target.value),S("")},className:"input-field pr-10",autoComplete:"new-password",autoFocus:!0,disabled:g}),e.jsx("button",{type:"button",onClick:()=>j(!p),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600",tabIndex:-1,children:p?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),e.jsx(n,{password:m})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1.5",children:l("auth.confirmNewPassword")}),e.jsx("input",{id:"confirmPassword",type:p?"text":"password",value:h,onChange:e=>{u(e.target.value),S("")},className:"input-field "+(h&&h!==m?"border-red-300 focus:ring-red-500 focus:border-red-500":h&&h===m?"border-green-300 focus:ring-green-500 focus:border-green-500":""),autoComplete:"new-password",disabled:g}),h&&h!==m&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:l("auth.passwordMismatch")})]}),e.jsx("button",{type:"submit",disabled:g||!i(m)||m!==h,className:"btn-primary w-full py-3 text-base",children:l(g?"app.loading":"auth.resetButton")})]})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsx("div",{className:"w-full max-w-[420px] text-center",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 bg-red-100 rounded-full mb-4",children:e.jsx("svg",{className:"w-7 h-7 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:l("auth.resetTitle")}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:N}),e.jsx(r,{to:"/forgot-password",className:"btn-primary inline-flex items-center gap-2 px-6 py-2.5",children:l("auth.forgotSend")}),e.jsx("div",{className:"mt-4",children:e.jsx(r,{to:"/login",className:"text-sm text-gray-500 hover:text-gray-700",children:l("auth.forgotBack")})})]})})})}export{l as default};
